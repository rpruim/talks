---
title: "dplyr and SQL"
author: "Randall Pruim"
date: "Big Data Ignite 2016"
output:
  beamer_presentation:
    colortheme: seagull
    fig_height: 3
    fig_width: 8
    fonttheme: professionalfonts
    includes:
      in_header: header.tex
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE, tidy=FALSE, size="small",
  fig.width=8, fig.height=6, 
  cache = TRUE, cache.path = "cache/dplyr-sql-")
```


## dplyr and SQL integration

`dplyr` provides SQL integration

  * backends for several flavors of SQL exist 
    * Postgres, MySQL, MariaDB, BigQuery
  
  * others coming 
    * MS SQL server
  
## airlines data via MySQL (Smith College)

A data base that includes information on US flights since 1987 is available from
Smith College

```{r, message = FALSE}
require(dplyr)
airlines <-
  src_mysql(
    "airlines", host = "scidb.smith.edu",
    user = "mth292", password = "RememberPi")
airlines
```

## Connecting to the tables

```{r}
Airports <- tbl(airlines, "airports")
Carriers <- tbl(airlines, "carriers")
Flights <- tbl(airlines, "flights")
Planes <- tbl(airlines, "planes")
Weather <- tbl(airlines, "weather")
```

## Taking a look

Weather data is only for NY airports in 2013.  Complete
24/7 data would include `r 24 * 365` records.

```{r}
head(Weather)
Weather %>%
  group_by(origin, year) %>%
  summarise(num_records = n())
```

